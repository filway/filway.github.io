import{g as e,f as t,G as r}from"./common-bec3f312.js";const n='{"title":"修改webpack配置完成打包分析和优化","frontmatter":{"date":"2022-08-09","title":"修改webpack配置完成打包分析和优化","tags":["vue-cli","webpack","nginx","项目优化"],"describe":"优化的手段的本质就是 减少代码体积 加快响应速度"},"headers":[{"level":2,"title":"个性化构建结果 - vue.config.js","slug":"个性化构建结果-vue-config-js"}],"relativePath":"docs/notes/Performance/04.md","lastUpdated":1660147426756.5005}';var o={};const l=r('<h2 id="个性化构建结果-vue-config-js"><a class="header-anchor" href="#个性化构建结果-vue-config-js" aria-hidden="true">#</a> 个性化构建结果 - vue.config.js</h2><p><strong>在基础的配置上，自定义构建的结果 - 可以使用 vue.config.js</strong> 文档地址：<a href="https://cli.vuejs.org/zh/config/#vue-config-js" target="_blank" rel="noopener noreferrer">https://cli.vuejs.org/zh/config/#vue-config-js</a></p><p>简介两个字段</p><ul><li><strong>PublicPath</strong> - 部署应用包时的基本 URL, 这个配置对应的是 webpack 的 PublicPath 属性 <ul><li>默认值为 ‘/’ , Vue CLI 会假设你的应用是被部署在一个域名的根路径上 <a href="https://abc.com/" target="_blank" rel="noopener noreferrer">https://abc.com/</a></li><li>可以设置为子路径 - 如果你的应用被部署在 <a href="https://abc.com/sub/" target="_blank" rel="noopener noreferrer">https://abc.com/sub/</a> 那么就设置为 ‘/sub’</li><li>可以设置为 CDN 路径 - 在我们的应用中，最后静态资源是要全部上传到 CDN 的，（脚手架自动完成），所以这里可以设置为一个 CDN 域名 - ‘<a href="https://oss.imooc-lego.com/editor%E2%80%99" target="_blank" rel="noopener noreferrer">https://oss.imooc-lego.com/editor’</a></li><li>还可以设置为相对路径（’’ 或者 ‘./’），这样所有的资源都会被链接为相对路径</li></ul></li><li><strong>css.loaderOptions</strong> 属性</li><li>向 CSS 相关的 loader 传递选项</li><li>Ant-design-vue 的样式变量：<a href="https://www.antdv.com/docs/vue/customize-theme-cn" target="_blank" rel="noopener noreferrer">https://www.antdv.com/docs/vue/customize-theme-cn</a></li><li><a href="https://github.com/vueComponent/ant-design-vue/blob/master/components/style/themes/default.less" target="_blank" rel="noopener noreferrer">https://github.com/vueComponent/ant-design-vue/blob/master/components/style/themes/default.less</a></li><li>添加更多的CSS预处理器：<a href="https://cli.vuejs.org/zh/guide/css.html#%E9%A2%84%E5%A4%84%E7%90%86%E5%99%A8" target="_blank" rel="noopener noreferrer">https://cli.vuejs.org/zh/guide/css.html#预处理器</a></li><li>特别注意 less 和 less-loader 的版本问题。不要装最新的，建议选用：</li></ul><div class="language-javascript"><pre><code>    <span class="token string">&quot;less&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.12.0&quot;</span><span class="token punctuation">,</span>\n    <span class="token string">&quot;less-loader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.1.0&quot;</span><span class="token punctuation">,</span>\n</code></pre></div><p><strong>bundle 打包分析工具</strong></p><p>webpack-bundle-analyzer - <a href="https://www.npmjs.com/package/webpack-bundle-analyzer" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/package/webpack-bundle-analyzer</a></p><ul><li>可以作为 webpack plugins 使用</li><li>可以作为 cli 命令行工具使用</li></ul><p><strong>特点和分析过程</strong></p><ul><li>分析 Bundle 由什么模块组成</li><li>分析什么模块占据了比较大的体积</li><li>分析是否有什么错误的模块被打包了</li></ul><p><strong>自定义 webpack 配置</strong><a href="https://cli.vuejs.org/zh/guide/webpack.html#%E7%AE%80%E5%8D%95%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F" target="_blank" rel="noopener noreferrer">https://cli.vuejs.org/zh/guide/webpack.html#简单的配置方式</a></p><p><strong>根据图表的优化步骤</strong> 2.25 M</p><ul><li>看看有没有什么重复的模块，或者没有用的模块被打包到了最终的代码中 <ul><li>看看 package.json，对比一下是否有应该在 devDeps 的模块，被错误的放置到了 deps 当中</li><li>检查是否有重复加载的模块，或者是功能大体相同的模块。 <ul><li>使用** es ** 版本的第三方库，享受 tree-shaking 的红利。 2.18M</li></ul></li><li>检查是否有没有用的模块是否打包到了最终的文件中。 1.95M <ul><li>使用 webpack ignore plugin <a href="https://webpack.js.org/plugins/ignore-plugin/#root" target="_blank" rel="noopener noreferrer">https://webpack.js.org/plugins/ignore-plugin/#root</a></li></ul></li></ul></li><li>按需加载 ant-design-vue 组件库 <ul><li><a href="https://2x.antdv.com/docs/vue/introduce-cn/" target="_blank" rel="noopener noreferrer">https://2x.antdv.com/docs/vue/introduce-cn/</a> 1.25M</li></ul></li></ul><p><strong>使用 SplitChunksPlugin 继续优化文件大小</strong></p><p>继续风格第三方库的优点</p><ul><li>充分利用浏览器的缓存</li><li>浏览器支持平行加载多个文件 <ul><li>HTTP1 对同一域名并行加载的个数限制</li><li>HTTP2 完全突破这个限制</li></ul></li><li>SplitChunksPlugin 文档地址：<a href="https://webpack.docschina.org/plugins/split-chunks-plugin/" target="_blank" rel="noopener noreferrer">https://webpack.docschina.org/plugins/split-chunks-plugin/</a></li></ul><p><strong>使用动态 import 优化路由</strong></p><ul><li>ES2015 关于 动态 import 的文档：<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/import#%E5%8A%A8%E6%80%81import" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/import#动态import</a></li><li>webpack 对动态 import 可以完美支持。</li><li>文档地址：<a href="https://webpack.docschina.org/guides/code-splitting/#dynamic-imports" target="_blank" rel="noopener noreferrer">https://webpack.docschina.org/guides/code-splitting/#dynamic-imports</a></li><li>webpack 使用 Magic Comments 来实现模块的不同操作。</li><li>文档地址：<a href="https://webpack.docschina.org/api/module-methods/#magic-comments" target="_blank" rel="noopener noreferrer">https://webpack.docschina.org/api/module-methods/#magic-comments</a></li><li>Vue Router 支持动态 import。</li><li>文档地址：<a href="https://next.router.vuejs.org/guide/advanced/lazy-loading.html" target="_blank" rel="noopener noreferrer">https://next.router.vuejs.org/guide/advanced/lazy-loading.html</a></li></ul><p><strong>细粒度配置 webpack 选项</strong></p><ul><li>链式操作： <a href="https://cli.vuejs.org/zh/guide/webpack.html#%E7%AE%80%E5%8D%95%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F" target="_blank" rel="noopener noreferrer">https://cli.vuejs.org/zh/guide/webpack.html#简单的配置方式</a></li><li>webpack-chain 插件地址：<a href="https://github.com/neutrinojs/webpack-chain" target="_blank" rel="noopener noreferrer">https://github.com/neutrinojs/webpack-chain</a></li></ul>',20);o.render=function(r,n,o,a,s,i){return t(),e("div",null,[l])};export default o;export{n as __pageData};
