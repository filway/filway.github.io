import{g as l,f as i,G as e}from"./common-bec3f312.js";const a='{"title":"流量指标","frontmatter":{"date":"2022-05-15","title":"流量指标","tags":["前端架构师","week27","前端监控"],"describe":null},"headers":[{"level":2,"title":"页面访问行为","slug":"页面访问行为"},{"level":3,"title":"指标库","slug":"指标库"},{"level":3,"title":"可视化","slug":"可视化"},{"level":2,"title":"模块访问行为","slug":"模块访问行为"},{"level":3,"title":"指标库","slug":"指标库-2"},{"level":3,"title":"可视化","slug":"可视化-2"},{"level":2,"title":"页面的性能","slug":"页面的性能"},{"level":3,"title":"指标库","slug":"指标库-3"},{"level":3,"title":"可视化","slug":"可视化-3"},{"level":2,"title":"页面异常监控","slug":"页面异常监控"},{"level":3,"title":"指标库","slug":"指标库-4"},{"level":3,"title":"可视化","slug":"可视化-4"},{"level":2,"title":"改动点","slug":"改动点"}],"relativePath":"docs/Front_arch/week27/01.md","lastUpdated":1660147426752.5005}';var n={};const t=e('<h1 id="流量指标"><a class="header-anchor" href="#流量指标" aria-hidden="true">#</a> 流量指标</h1><h2 id="页面访问行为"><a class="header-anchor" href="#页面访问行为" aria-hidden="true">#</a> 页面访问行为</h2><h3 id="指标库"><a class="header-anchor" href="#指标库" aria-hidden="true">#</a> 指标库</h3><ul><li>PV：页面浏览量，count(type = pv)</li><li>UV：用户浏览量，count(type = pv, distinct visitor_id) <ul><li>visitor_id 不能 null <ul><li>对于未登录用户，需要在客户端生成 visitor_id（uuid 持久化存储）</li><li>对于已登录用户，需要获取用户的 user_id，并将 user_id 写入 visitor_id</li></ul></li></ul></li><li>PV点击率：页面点击率，count(type = click) / PV <ul><li>可以大于100%</li></ul></li><li>UV点击率：用户点击率，count(type = click, distinct visitor_id) / UV <ul><li>不可以大于100%</li></ul></li><li>停留时长：用户从打开页面到关闭页面的总时长，leave page time（beforeunonload） - open time（onload）</li></ul><h3 id="可视化"><a class="header-anchor" href="#可视化" aria-hidden="true">#</a> 可视化</h3><ul><li>通过折线图的方式，展示24小时内每小时页面指标</li><li>通过表格的方式，展示一定时间段内页面的指标</li></ul><h2 id="模块访问行为"><a class="header-anchor" href="#模块访问行为" aria-hidden="true">#</a> 模块访问行为</h2><h3 id="指标库-2"><a class="header-anchor" href="#指标库-2" aria-hidden="true">#</a> 指标库</h3><ul><li>模块曝光：模块显示时发送的埋点，count(type = exp, mod=mod_id)</li><li>模块点击：模块被点击时发送的埋点，count(type = click, mod=mod_id)</li></ul><h3 id="可视化-2"><a class="header-anchor" href="#可视化-2" aria-hidden="true">#</a> 可视化</h3><ul><li>通过表格的方式，展示某个页面中所有模块的曝光和点击数据</li></ul><h2 id="页面的性能"><a class="header-anchor" href="#页面的性能" aria-hidden="true">#</a> 页面的性能</h2><h3 id="指标库-3"><a class="header-anchor" href="#指标库-3" aria-hidden="true">#</a> 指标库</h3><ul><li>首屏渲染时间：从打开页面到页面完全加载的时间，计算公式：</li></ul><div class="language-js"><pre><code>window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> performance<span class="token punctuation">.</span>timing<span class="token punctuation">.</span>navigationStart \n<span class="token punctuation">}</span>\n</code></pre></div><ul><li>API请求时间：API发起，到API响应的时间，计算公式：API响应时间 - API发起时间</li></ul><h3 id="可视化-3"><a class="header-anchor" href="#可视化-3" aria-hidden="true">#</a> 可视化</h3><ul><li>折线图</li><li>表格</li></ul><h2 id="页面异常监控"><a class="header-anchor" href="#页面异常监控" aria-hidden="true">#</a> 页面异常监控</h2><h3 id="指标库-4"><a class="header-anchor" href="#指标库-4" aria-hidden="true">#</a> 指标库</h3><ul><li>JS Error： <ul><li>全局的jserror：window.onerror</li><li>全局的promise error：window.onunhandledrejection</li><li>自定义抛出的jserror：自定义上报 stack 和 message</li></ul></li><li>API Error：API响应过程中，出现异常的信息, count(type = api_error)</li><li>业务异常：完全上报的方式进行实现，count(type = biz_error)</li></ul><h3 id="可视化-4"><a class="header-anchor" href="#可视化-4" aria-hidden="true">#</a> 可视化</h3><ul><li>折线图</li><li>表格</li></ul><h2 id="改动点"><a class="header-anchor" href="#改动点" aria-hidden="true">#</a> 改动点</h2><ul><li><p>页面</p><ol><li>（已完成）在 imooc_monitor 表中添加 user_id 和 visitor_id 两个字段</li><li>（已完成）在 SDK 中添加获取 user_id 和 visitor_id 的逻辑，并判断当 visitor_id 不存在时，自动生成</li><li>（已完成）在 SDK 中针对页面 click 事件进行监听，当触发 click 事件时自动进行上报</li><li>（已完成）在 SDK 中添加自动获取用户停留时长的逻辑</li></ol><blockquote><p>参考：<a href="https://developer.mozilla.org/zh-CN/docs/conflicting/web/api/window/beforeunload_event" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-CN/docs/conflicting/web/api/window/beforeunload_event</a></p></blockquote></li><li><p>模块</p><ol><li>（已完成）在 imooc_monitor 表中添加 mod_id 字段，用于标识模块曝光和点击信息</li><li>（已完成）在 SDK 中添加上报日志时，获取 mod_id 的逻辑</li></ol></li><li><p>性能</p><ol><li>（已完成）在 SDK 中添加性能采集日志，并自动完成上报</li><li>（已完成）在 SDK 中添加上报 API 请求时间的 API</li></ol></li><li><p>异常</p><ol><li>（已完成）在 SDK 中添加全局异常监控日志上报</li><li>（已完成）在 SDK 中添加全局promise异常监控日志上报</li><li>（已完成）在 SDK 中添加自定义上报 API</li><li>（已完成）在 SDK 中添加 API 异常上报 API</li><li>（已完成）在 SDK 中添加业务异常上报 API</li></ol></li></ul>',25);n.render=function(e,a,n,s,o,r){return i(),l("div",null,[t])};export default n;export{a as __pageData};
