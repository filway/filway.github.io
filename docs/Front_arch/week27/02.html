<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>
      性能监控 | filway
    </title>
    <meta name="description" content="A VitePress site">
    <link rel="stylesheet" href="/_assets/style.6c30fbeb.css">
    <link rel="modulepreload" href="/_assets/common-bec3f312.js">
    <link rel="modulepreload" href="/_assets/docs_Front_arch_week27_02.md.150d9cd8.lean.js">
    <link rel="modulepreload" href="/_assets/app.d18979ca.js">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta name="keywords" content="filway,技术博客,记录日常">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.css">
    <script src="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.js"></script>
    <script src="https://lib.baomitu.com/axios/0.21.1/axios.js"></script>
    <script async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6346362766172412" crossorigin="anonymous"></script>
    
  </head>
  <body>
    <div id="app"><!--[--><div id="containerColor" class="no-sidebar theme" data-v-2001909f><header class="navbar" data-v-2001909f><!--[--><a class="title" aria-label="filway, back to home" href="/"><img class="logo" src="/favicon.ico" alt="logo"><span>filway</span></a><div class="flex-grow"></div><nav class="nav-links hide-mobile" data-v-2001909f><!--[--><!--[--><div class="nav-item" data-v-2001909f><a class="nav-link" href="/index.html" target="" rel="">🏠 首页 <!----></a></div><!--]--><!--[--><div class="nav-item" data-v-2001909f><a class="nav-link" href="/more/docs.html" target="" rel="">📅 归档 <!----></a></div><!--]--><!--[--><div class="nav-item" data-v-2001909f><a class="nav-link" href="/more/tags.html" target="" rel="">📂 分类 <!----></a></div><!--]--><!--[--><div class="nav-item" data-v-2001909f><a class="nav-link" href="/more/Friendship.html" target="" rel="">👫 友情链接 <!----></a></div><!--]--><!--]--><!----><!----></nav><!--[--><!--[--><!--]--><!--]--><!--]--><div class="sidebar-button" data-v-2001909f><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div></header><aside class="" data-v-2001909f><!--[--><nav class="nav-links show-mobile" data-v-2001909f><!--[--><!--[--><div class="nav-item" data-v-2001909f><a class="nav-link" href="/index.html" target="" rel="">🏠 首页 <!----></a></div><!--]--><!--[--><div class="nav-item" data-v-2001909f><a class="nav-link" href="/more/docs.html" target="" rel="">📅 归档 <!----></a></div><!--]--><!--[--><div class="nav-item" data-v-2001909f><a class="nav-link" href="/more/tags.html" target="" rel="">📂 分类 <!----></a></div><!--]--><!--[--><div class="nav-item" data-v-2001909f><a class="nav-link" href="/more/Friendship.html" target="" rel="">👫 友情链接 <!----></a></div><!--]--><!--]--><!----><!----></nav><!--[--><!--[--><!--]--><!--]--><ul class="sidebar"><!--[--><!--]--></ul><!--[--><!--[--><!--]--><!--]--><!--]--></aside><!----><!-- TODO: make this button accessible --><div class="sidebar-mask" data-v-2001909f></div><main data-v-2001909f><!--[--><div class="content"><!--[--><!--[--><!--]--><!--]--><div class="md-header"><div class="md-title">性能监控</div><span id="jinrishici-sentence">正在加载今日诗词....</span><div class="md-date">2022-05-15</div></div><ul class="catalog"><!--[--><li class="catalog-item"><a class="level level-2" href="#fp（first-paint）">FP（First Paint）</a><!----></li><li class="catalog-item"><a class="level level-2" href="#fcp（first-contentful-paint）">FCP（First contentful paint）</a><!----></li><li class="catalog-item"><a class="level level-2" href="#lcp（largestcontentfulpaint）">LCP（LargestContentfulPaint）</a><!----></li><li class="catalog-item"><a class="level level-2" href="#fmp（first-meaningful-paint）">FMP（First Meaningful Paint）</a><!----></li><li class="catalog-item"><a class="level level-2" href="#dcl（domcontentloaded）">DCL（DOMContentLoaded）</a><!----></li><li class="catalog-item"><a class="level level-2" href="#l（load）">L（load）</a><!----></li><li class="catalog-item"><a class="level level-2" href="#performancetiming">PerformanceTiming</a><!----></li><li class="catalog-item"><a class="level level-2" href="#获取fp、fcp、fmp（performancepainttiming）">获取fp、fcp、fmp（PerformancePaintTiming）</a><!----></li><li class="catalog-item"><a class="level level-2" href="#获取更多性能指标：performanceobserver">获取更多性能指标：PerformanceObserver</a><!----></li><!--]--></ul><div data-v-2001909f><h1 id="前端性能监控平台架构"><a class="header-anchor" href="#前端性能监控平台架构" aria-hidden="true">#</a> 前端性能监控平台架构</h1><p><img src="https://oss.filway.cn/filway-blog/6279c7df090bb97615000748.jpg" alt="图片描述"></p><h1 id="前端性能监控原理"><a class="header-anchor" href="#前端性能监控原理" aria-hidden="true">#</a> 前端性能监控原理</h1><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Navigation_timing_API" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/API/Navigation_timing_API</a><img src="https://oss.filway.cn/filway-blog/6279c7fb0902e9d014580870-20220515003445109.jpg" alt="图片描述"><img src="https://oss.filway.cn/filway-blog/6279c82709f42f9f15000807.jpg" alt="图片描述"> Chrome Performance插件 <img src="https://oss.filway.cn/filway-blog/6279c83909fef4a515000554.jpg" alt="图片描述"></p><h2 id="fp（first-paint）"><a class="header-anchor" href="#fp（first-paint）" aria-hidden="true">#</a> FP（First Paint）</h2><p>First Paint, part of the <a href="https://developer.mozilla.org/en-US/docs/Web/PerformancePaintTiming" target="_blank" rel="noopener noreferrer">Paint Timing API</a>, is the time between navigation and when the browser renders the first pixels to the screen, rendering anything that is visually different from what was on the screen prior to navigation. It answers the question &quot;Is it happening?&quot; <a href="https://developer.mozilla.org/en-US/docs/Glossary/First_paint" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/en-US/docs/Glossary/First_paint</a></p><h2 id="fcp（first-contentful-paint）"><a class="header-anchor" href="#fcp（first-contentful-paint）" aria-hidden="true">#</a> FCP（First contentful paint）</h2><p>First Contentful Paint (FCP) is when the browser renders the first bit of content from the DOM, providing the first feedback to the user that the page is actually loading. The question “Is it happening?” is “yes” when the first contentful paint completes. <a href="https://developer.mozilla.org/en-US/docs/Glossary/First_contentful_paint" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/en-US/docs/Glossary/First_contentful_paint</a></p><h2 id="lcp（largestcontentfulpaint）"><a class="header-anchor" href="#lcp（largestcontentfulpaint）" aria-hidden="true">#</a> LCP（LargestContentfulPaint）</h2><p>The LargestContentfulPaint interface of the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Largest_Contentful_Paint_API" target="_blank" rel="noopener noreferrer">Largest Contentful Paint API</a> provides details about the largest image or text paint before user input on a web page. The timing of this paint is a good heuristic for when the main page content is available during load. <a href="https://developer.mozilla.org/en-US/docs/Web/API/LargestContentfulPaint" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/en-US/docs/Web/API/LargestContentfulPaint</a></p><h2 id="fmp（first-meaningful-paint）"><a class="header-anchor" href="#fmp（first-meaningful-paint）" aria-hidden="true">#</a> FMP（First Meaningful Paint）</h2><p>First Meaningful Paint (FMP) is the paint after which the biggest above-the-fold layout change has happened and web fonts have loaded. It is when the answer to “Is it useful?” becomes “yes”, upon first meaningful paint completion. <a href="https://developer.mozilla.org/en-US/docs/Glossary/first_meaningful_paint" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/en-US/docs/Glossary/first_meaningful_paint</a></p><h2 id="dcl（domcontentloaded）"><a class="header-anchor" href="#dcl（domcontentloaded）" aria-hidden="true">#</a> DCL（DOMContentLoaded）</h2><p>The DOMContentLoaded event fires when the initial HTML document has been completely loaded and parsed, without waiting for stylesheets, images, and subframes to finish loading. <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/DOMContentLoaded_event" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/en-US/docs/Web/API/Window/DOMContentLoaded_event</a></p><h2 id="l（load）"><a class="header-anchor" href="#l（load）" aria-hidden="true">#</a> L（load）</h2><p>The load event is fired when the whole page has loaded, including all dependent resources such as stylesheets and images. This is in contrast to DOMContentLoaded, which is fired as soon as the page DOM has been loaded, without waiting for resources to finish loading. <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/load_event" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/en-US/docs/Web/API/Window/load_event</a></p><blockquote><p>前端名词解释：<a href="https://github.com/mdn/content/tree/main/files/en-us/glossary" target="_blank" rel="noopener noreferrer">https://github.com/mdn/content/tree/main/files/en-us/glossary</a></p></blockquote><p><img src="https://oss.filway.cn/filway-blog/6279c85709e567f815000538.jpg" alt="图片描述"></p><h1 id="前端性能采集"><a class="header-anchor" href="#前端性能采集" aria-hidden="true">#</a> 前端性能采集</h1><h2 id="performancetiming"><a class="header-anchor" href="#performancetiming" aria-hidden="true">#</a> PerformanceTiming</h2><div class="language-javascript"><pre><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;load&#39;</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// PerformanceTiming 毫秒</span>
  <span class="token keyword">const</span> timing <span class="token operator">=</span> window<span class="token punctuation">.</span>performance<span class="token punctuation">.</span>timing<span class="token punctuation">;</span>
  <span class="token keyword">const</span> processingTiming <span class="token operator">=</span> timing<span class="token punctuation">.</span>domComplete <span class="token operator">-</span> timing<span class="token punctuation">.</span>domLoading<span class="token punctuation">;</span>
  <span class="token keyword">const</span> dnsTiming <span class="token operator">=</span> timing<span class="token punctuation">.</span>domainLookupStart <span class="token operator">-</span> timing<span class="token punctuation">.</span>domainLookupEnd<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>processingTiming<span class="token punctuation">,</span> dnsTiming<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// PerformanceNavigationTiming 纳秒</span>
  <span class="token keyword">const</span> perfEntries <span class="token operator">=</span> window<span class="token punctuation">.</span>performance<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>perfEntries<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="获取fp、fcp、fmp（performancepainttiming）"><a class="header-anchor" href="#获取fp、fcp、fmp（performancepainttiming）" aria-hidden="true">#</a> 获取fp、fcp、fmp（PerformancePaintTiming）</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformancePaintTiming" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/en-US/docs/Web/API/PerformancePaintTiming</a></p><div class="language-javascript"><pre><code><span class="token comment">// fp</span>
<span class="token keyword">const</span> paint <span class="token operator">=</span> window<span class="token punctuation">.</span>performance<span class="token punctuation">.</span><span class="token function">getEntriesByType</span><span class="token punctuation">(</span><span class="token string">&#39;paint&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fp <span class="token operator">=</span> paint<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> e<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&#39;first-paint&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>startTime<span class="token punctuation">;</span>
<span class="token keyword">const</span> fcp <span class="token operator">=</span> paint<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> e<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&#39;first-contentful-paint&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>startTime<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> fcp<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="获取更多性能指标：performanceobserver"><a class="header-anchor" href="#获取更多性能指标：performanceobserver" aria-hidden="true">#</a> 获取更多性能指标：PerformanceObserver</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceObserver" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/en-US/docs/Web/API/PerformanceObserver</a></p><div class="language-javascript"><pre><code><span class="token comment">// PerformanceObserver</span>
<span class="token keyword">function</span> <span class="token function">observer_callback</span><span class="token punctuation">(</span><span class="token parameter">list<span class="token punctuation">,</span> observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  list<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span>observer_callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span> entryTypes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;paint&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;resource&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;mark&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

window<span class="token punctuation">.</span>performance<span class="token punctuation">.</span><span class="token function">mark</span><span class="token punctuation">(</span><span class="token string">&#39;own&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div><div class="links-wrapper" data-v-2001909f><div class="prev-link"><!----></div><div class="next-link"><!----></div></div><div data-v-2001909f><!-- <footer class="page-edit">
      <a v-for="(item, index) in data.platform" :key="index" :href="item.href">
        <img class="imgIcon" :src="item.icon" />
      </a>
    </footer>
    <p class="platform">
      以上皆为
      <a href="javascript:;">filway</a> 文章发布平台
    </p> --><p class="platform"> Copyright © 2022 <a href="https://github.com/filway">@filway</a></p></div><!--[--><!--[--><!--]--><!--]--></div><!-- 只想点击背景才关闭 请使用 .self 修饰符 --><div style="display:none;" class="imgBox"><img src=""></div><!--]--></main><div class="theme-select" data-v-2001909f><ul data-v-2001909f><li class="active" data-v-2001909f>☀️</li><li class="" data-v-2001909f> 🌑 </li></ul></div></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"README.md\":\"5ccc2232\",\"index.md\":\"234e1fb7\",\"more_Friendship.md\":\"c4000430\",\"more_docs.md\":\"9824001f\",\"more_index.md\":\"7a95c2a3\",\"more_tags.md\":\"6e9db034\",\"docs_eggjs_01.md\":\"3f24c7fb\",\"docs_layout_css_file.md\":\"5d80647e\",\"docs_layout_css_method.md\":\"57806677\",\"docs_layout_mobile.md\":\"7ae85dd0\",\"docs_layout_restore-ui-design.md\":\"caa6d221\",\"docs_notes_acme-sh.md\":\"8d928bd0\",\"docs_notes_deploy.md\":\"78b9b91f\",\"docs_notes_fe-component-platform.md\":\"cf8df577\",\"docs_notes_gitflow.md\":\"3057c81f\",\"docs_notes_github-page.md\":\"da33afaa\",\"docs_notes_nginx.md\":\"7e7340f2\",\"docs_notes_nodebestpractices.md\":\"e3a4283e\",\"docs_notes_safe.md\":\"42e14477\",\"docs_notes_vue-router-next.md\":\"ab02fe57\",\"docs_Front_arch_week2_02.md\":\"b94e373b\",\"docs_Front_arch_week2_03.md\":\"2933158b\",\"docs_Front_arch_week2_04.md\":\"2d054f72\",\"docs_Front_arch_week2_05.md\":\"ff75d15e\",\"docs_Front_arch_week2_06.md\":\"7e2667ad\",\"docs_Front_arch_week2_07.md\":\"2fb9bbcd\",\"docs_Front_arch_week2_08.md\":\"f73dff18\",\"docs_Front_arch_week27_01.md\":\"ac602789\",\"docs_Front_arch_week27_02.md\":\"150d9cd8\",\"docs_Front_arch_week28_01.md\":\"45111e1d\",\"docs_Front_arch_week28_02.md\":\"5baac625\",\"docs_Front_arch_week29_01.md\":\"915859dd\",\"docs_Front_arch_week29_02.md\":\"a50758e2\",\"docs_Front_arch_week29_03.md\":\"60fd2bf8\",\"docs_Front_arch_week3_00.md\":\"9482ad18\",\"docs_Front_arch_week3_01.md\":\"d26e5f51\",\"docs_Front_arch_week3_02.md\":\"09a24585\",\"docs_Front_arch_week3_03.md\":\"d4167023\",\"docs_Front_arch_week3_04.md\":\"57dc2283\",\"docs_Front_arch_week3_05.md\":\"18dcc905\",\"docs_Front_arch_week30_01.md\":\"d7b5fad6\",\"docs_Front_arch_week30_02.md\":\"f3f46a49\",\"docs_Front_arch_week31_01.md\":\"fe23274a\",\"docs_Front_arch_week33_01.md\":\"0b1ec120\",\"docs_Front_arch_week4_01.md\":\"d0e0afe1\",\"docs_Front_arch_week4_02.md\":\"125d6466\",\"docs_Front_arch_week4_03.md\":\"519499d9\",\"docs_Front_arch_week4_04.md\":\"9a0ecb5b\",\"docs_Front_arch_week5_01.md\":\"7d7e87ec\",\"docs_Front_arch_week5_02.md\":\"4bb88c22\",\"docs_Front_arch_week5_03.md\":\"a04c0779\",\"docs_Front_arch_week6_01.md\":\"292eb8ff\",\"docs_Front_arch_week6_02.md\":\"9ee0b478\",\"docs_Front_arch_week6_03.md\":\"750443e4\",\"docs_Front_arch_week9-xmdj_dx.md\":\"524fe2b9\",\"docs_Front_arch_week9-xmdj_qdgjl.md\":\"fa2cadde\",\"docs_Front_arch_week9-xmdj_xmdj.md\":\"f2040f48\",\"docs_front_monitoring_js_lib_js_sdk.md\":\"945697ff\",\"docs_front_monitoring_js_lib_quick_start.md\":\"cc99de3f\",\"docs_notes_Flutter_APP_homepage.md\":\"0745ccc8\",\"docs_notes_Flutter_animation.md\":\"e0bd035f\",\"docs_notes_Flutter_error.md\":\"e35b38b0\",\"docs_notes_Flutter_expansion_tile.md\":\"4cf78a31\",\"docs_notes_Flutter_future.md\":\"0dca4e38\",\"docs_notes_Flutter_gridview.md\":\"4905765c\",\"docs_notes_Flutter_http.md\":\"b7d272e2\",\"docs_notes_Flutter_image_widget.md\":\"554b379b\",\"docs_notes_Flutter_json.md\":\"6faeff9d\",\"docs_notes_Flutter_list_pulldown.md\":\"ba2aa6f4\",\"docs_notes_Flutter_list_view.md\":\"7509e452\",\"docs_notes_Flutter_shared_preferences.md\":\"ce55aee9\",\"docs_notes_Performance_01.md\":\"1800305d\",\"docs_notes_Performance_02.md\":\"bf67a458\",\"docs_notes_Performance_03.md\":\"a00f4a3f\",\"docs_notes_Performance_04.md\":\"8492a9bb\",\"docs_notes_Performance_05.md\":\"0cc82c11\",\"docs_notes_vnpn_01.md\":\"81d2f56f\"}")</script>
    <script type="module" async src="/_assets/app.d18979ca.js"></script>
  </body>
</html>